USE MSIS230;

DROP TABLE IF EXISTS DIAGNOSIS;
DROP TABLE IF EXISTS MEDICAL_HISTORY;
DROP TABLE IF EXISTS APPOINTMENT;
DROP TABLE IF EXISTS EMPLOYEE_SCHEDULE;
DROP TABLE IF EXISTS EMPLOYEE_SPECIALTY;
DROP TABLE IF EXISTS EMPLOYEE;
DROP TABLE IF EXISTS PRESCRIPTION;
DROP TABLE IF EXISTS MEDICAL_CONDITION;
DROP TABLE IF EXISTS EMPLOYEE_TYPE;
DROP TABLE IF EXISTS SURGERY;
DROP TABLE IF EXISTS SPECIALTY;
DROP TABLE IF EXISTS PATIENTS;

CREATE TABLE IF NOT EXISTS PATIENTS
(
PATIENT_ID varchar(10) primary key,
PATIENT_PASSWORD varchar(25) not null,
PATIENT_LNAME varchar(25) not null,
PATIENT_FNAME varchar(25) not null,
STREET varchar(25),
CITY varchar(20),
STATE char(2),
ZIP varchar(10),
GENDER char(1)
);

CREATE TABLE IF NOT EXISTS SPECIALTY
(
SPECIALTY_ID varchar(5) primary key,
SPEC_DESCRIPTION varchar(20) not null
);

CREATE TABLE IF NOT EXISTS SURGERY
(
SURGERY_ID varchar(5) primary key,
SURG_DESCRIPTION varchar(20) not null
);

CREATE TABLE IF NOT EXISTS EMPLOYEE_TYPE
(
TYPE_ID varchar(10) primary key,
TYPE_DESCRIPTION varchar(20) not null
);

CREATE TABLE IF NOT EXISTS MEDICAL_CONDITION
(
CONDITION_ID varchar(5) primary key,
COND_DESCRIPTION varchar(20) not null
);

CREATE TABLE IF NOT EXISTS PRESCRIPTION
(
PRESCRIPTION_ID varchar(5) primary key,
PRESC_DESCRIPTION varchar(20) not null
);

CREATE TABLE IF NOT EXISTS EMPLOYEE
(
EMPLOYEE_ID VARCHAR(10) PRIMARY KEY,
EMP_PASSWORD varchar(10) not null,
EMP_LNAME varchar(25) not null,
EMP_FNAME varchar(25) not null,
TYPE_ID varchar(3) not null,
GENDER char(1),
DATE_OF_HIRE datetime not null,
constraint FK_EMPLOYEE foreign key (TYPE_ID) references EMPLOYEE_TYPE (TYPE_ID)
);

CREATE TABLE IF NOT EXISTS EMPLOYEE_SPECIALTY
(
EMPLOYEE_ID varchar(10),
SPECIALTY_ID varchar(10),
constraint PK_EMPLOYEESPECIALTY primary key (EMPLOYEE_ID, SPECIALTY_ID),
constraint FK_EMP_SPECIALTY foreign key (EMPLOYEE_ID) references EMPLOYEE (EMPLOYEE_ID)
);

CREATE TABLE IF NOT EXISTS EMPLOYEE_SCHEDULE
(
EMPLOYEE_ID varchar(10),
DAY_OF_WEEK char(2),
START_TIME datetime not null,
END_TIME datetime not null,
constraint PK_EMPLOYEE_SCHEDULE primary key (EMPLOYEE_ID, DAY_OF_WEEK),
constraint FK_EMPLOYEE_SCHEDULE foreign key (EMPLOYEE_ID) references EMPLOYEE(EMPLOYEE_ID)
);

CREATE TABLE IF NOT EXISTS APPOINTMENT
(
APPOINTMENT_ID varchar(5),
PATIENT_ID varchar(10) not null,
EMPLOYEE_ID varchar(10) not null,
AP_DATE datetime not null,
START_TIME time not null,
DURATION varchar(10),
AP_STATUS varchar(10),
constraint PK_APP primary key (APPOINTMENT_ID),
constraint FK_APPOINTMENT foreign key (PATIENT_ID) references PATIENTS(PATIENT_ID),
constraint FK_APPOINT foreign key (EMPLOYEE_ID) references EMPLOYEE(EMPLOYEE_ID)
);

CREATE TABLE IF NOT EXISTS MEDICAL_HISTORY
(
PATIENT_ID varchar(10),
MED_HISTORY_DATE datetime,
CONDITION_ID varchar(5),
SURGERY_ID varchar(5),
PRESCRIPTION_ID varchar(5),
constraint PK_MEDICAL_HIST primary key (PATIENT_ID, MED_HISTORY_DATE),
constraint FK_MEDHISTORY foreign key (PATIENT_ID) references PATIENTS (PATIENT_ID),
constraint FK_MEDHIST foreign key (CONDITION_ID) references MEDICAL_CONDITION (CONDITION_ID),
constraint FK_MEDICHIST foreign key (SURGERY_ID) references SURGERY (SURGERY_ID),
constraint FK_MEDICHISTORY foreign key (PRESCRIPTION_ID) references PRESCRIPTION (PRESCRIPTION_ID)
);

CREATE TABLE IF NOT EXISTS DIAGNOSIS
(
APPOINTMENT_ID varchar(5),
CONDITION_ID varchar(5),
DIAGNOSIS varchar(255),
PRESCRIPTION_ID varchar(5) not null,
constraint PK_DIAGNOSIS primary key (APPOINTMENT_ID, CONDITION_ID),
constraint FK_DIAGNO foreign key (APPOINTMENT_ID) references APPOINTMENT(APPOINTMENT_ID),
constraint FK_DIAG foreign key (CONDITION_ID) references MEDICAL_CONDITION (CONDITION_ID),
constraint FK_DNOSIS foreign key (PRESCRIPTION_ID) references PRESCRIPTION (PRESCRIPTION_ID)
);



